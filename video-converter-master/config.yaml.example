server:
  port: 8080
  host: 0.0.0.0

scanner:
  root_path: /mnt/storage/videos
  video_extensions:
    - .mp4
    - .mkv
    - .mov
    - .avi
    - .flv
    - .webm
    - .m4v
  output_base: /mnt/storage/converted
  recursive_depth: -1  # -1 for unlimited, 0 for root only, >0 for specific depth
  scan_interval: 5m    # How often to scan for new files (e.g., 5m, 1h). Set to 0 to disable periodic scanning
  min_file_size: 0     # Minimum file size in bytes (0 = no minimum)
  max_file_size: 0     # Maximum file size in bytes (0 = no maximum)
  skip_hidden_files: true   # Skip files starting with '.'
  skip_hidden_dirs: true    # Skip directories starting with '.'
  replace_source: false     # Replace source file with output (use with caution!)
  detect_duplicates: true   # Detect and skip duplicate files based on content hash

database:
  path: ./jobs.db

conversion:
  target_resolution: 1920x1080
  codec: h264
  bitrate: 5M
  preset: fast
  audio_codec: aac
  audio_bitrate: 128k
  output_format: mp4  # mp4, mkv, webm, avi

# Worker defaults - these settings are provided to workers when they connect
# Workers can be started with just: worker -url http://master:8080
# and they will receive all these settings from the master
worker_defaults:
  concurrency: 3               # Number of concurrent jobs per worker
  heartbeat_interval: 30s      # How often workers send heartbeat
  job_check_interval: 5s       # How often workers check for new jobs
  job_timeout: 2h              # Maximum time for a single job
  max_api_requests_per_min: 60 # Rate limit for API calls to master
  max_backoff_interval: 30s    # Maximum backoff when no jobs available
  initial_backoff_interval: 1s # Initial backoff when no jobs available
  download_timeout: 30m        # Timeout for downloading source videos
  upload_timeout: 30m          # Timeout for uploading converted videos
  max_cache_size: 10737418240  # 10GB maximum cache size
  cache_cleanup_age: 24h       # Age after which cached files are cleaned up
  bandwidth_limit: 0           # Bandwidth limit in bytes per second (0 = unlimited)
  enable_resume_download: true # Enable resume support for downloads
  use_vulkan: true             # Enable Vulkan GPU acceleration if available
  ffmpeg_timeout: 2h           # FFmpeg conversion timeout
  log_level: info              # Worker log level (debug, info, warn, error)
  log_format: json             # Worker log format (json, text)

logging:
  level: info
  format: json
  output_path: ./master.log
